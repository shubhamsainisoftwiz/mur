<nb-card class="px-2">
  <nb-card-header class="row align-items-center justify-content-between">
    <div class="col-md-10 text-start">
      <h5 style="font-weight: 600">MIS Summary</h5>
    </div>

    <div class="col-md-2 pr-0">
      <form [formGroup]="nbForm" class="col-md-12 row p-0 m-0 justify-content-center">
        <div class="p-1">
          <p-calendar formControlName="YearDate" view="year" (ngModelChange)="getFormValue()" dateFormat="yy"
            placeholder="Select Year" [readonlyInput]="true"></p-calendar>
          <!-- <nb-calendar [(date)]="date" [boundingMonth]="true"></nb-calendar> -->
        </div>
      </form>
    </div>
    <hr>

  </nb-card-header>
  <div class="d-flex  justify-content-between py-3">
    <div>
      <button nbButton [status]="activeIndex === 0 ? 'primary' : 'control'"
        [ngClass]="activeIndex===0?'':'button-table'" class="mr-2" (click)="activeState('MTD')" label="">MTD Summary
      </button>
      <button nbButton [status]="activeIndex === 1 ? 'primary' : 'control'"
        [ngClass]="activeIndex===1?'':'button-table'" (click)="activeState('YTD')" label="">
        YTD Summary</button>
      <button nbButton [status]="activeIndex === 2 ? 'primary' : 'control'"
        [ngClass]="activeIndex===2?'':'button-table'" (click)="activeState('QTD')" label="">
        QTD Summary </button>
    </div>

  </div>
</nb-card>

<nb-card >
  <nb-card-body class="mb-4" [nbSpinner]="preloading" nbSpinnerStatus="primary" nbSpinnerSize="large"
    nbSpinnerMessage="">
    <div id="startDocument" class="row justify-content-between" style="max-height: 52vh">
 

      <div class="col-12" *ngIf="!preloading" id="firstDiv" #target>
        <h6 class="my-3" style="font-weight: 600">MTD Summary Monthly</h6>
        <p-table *ngIf="budgetSummaryDetails" #dt1 [value]="budgetSummaryDetails"
          class="p-datatable p-component p-datatable-sm" dataKey="CleaningType" [showCurrentPageReport]="true"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
          [globalFilterFields]="['CleaningType']" [tableStyle]="{ 'min-width': '40rem' }" [columns]="cols">
          <ng-template pTemplate="header" style="border-bottom: none; border: 2px solid" let-columns>
            <tr>
              <th rowspan="2" style="width: 25%">Cost Heads</th>
              <ng-container *ngFor="let item of budgetSummary">
                <th colspan="3" class="text-center">
                  {{ item?.MonthName }}-{{ item?.Year }}
                </th>
              </ng-container>
            </tr>
            <tr>
              <ng-container *ngFor="let item of budgetSummary">
                <th pSortableColumn="Budget">
                  Budget
                </th>
                <th pSortableColumn="Actual">
                  Actual
                </th>
                <th pSortableColumn="Difference">
                  Diff.
                </th>
              </ng-container>
              <!-- <th style="width: 2%; color"></th> -->
            </tr>
          </ng-template>

          <!-- ... (previous code) ... -->

          <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr>
              <!-- <td>{{ rowData.CleaningType }}</td> -->
              <td *ngIf="rowData?.CleaningType === 'TCC'">
                Total Cleaning Costs
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCB'">
                Additional Crew Bonus
              </td>
              <td *ngIf="rowData?.CleaningType === 'ITD'">
                Idle Time Days For Cleaning
              </td>
              <td *ngIf="rowData?.CleaningType === 'SHA'">
                Hold Advisory by Shore & Roving Supdt Cost
              </td>
              <td *ngIf="rowData?.CleaningType === 'ITC'">
                Idle Time Cost (Fixture Costs)
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCE'">
                Hold Cleaning Equipment
              </td>
              <td *ngIf="rowData?.CleaningType === 'ITB'">
                Idle Time Bunker $ (LSF+LSG)
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCC'">
                Hold Cleaning Chemicals
              </td>
              <td *ngIf="rowData?.CleaningType === 'SCG'">
                Shore Cleaning Gang
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCX'">
                Hold Cleaning Consumables
              </td>
              <ng-container *ngFor="let month of budgetSummary">
                <ng-container *ngIf="getMonthlyBudget(month, rowData,'monthly')">
                  <td>
                    <div [ngClass]="checkListRecord === false ? 'd-none' : ''">
                      {{ getMonthlyBudget(month, rowData,'monthly').Budget.BudgetSum | currency:'USD':'symbol':'1.0-0'
                      }}
                    </div>
                    <ngx-skeleton-loader [ngClass]="checkListRecord === true ? 'd-none' : ''" count="1"
                      appearance="line" animation="pulse">
                    </ngx-skeleton-loader>
                  </td>
                  <td>
                    <div [ngClass]="checkListRecord === false ? 'd-none' : ''">
                      {{ getMonthlyBudget(month, rowData,'monthly').Budget.ActualSum | currency:'USD':'symbol':'1.0-0'
                      }}
                    </div>
                    <ngx-skeleton-loader [ngClass]="checkListRecord === true ? 'd-none' : ''" count="1"
                      appearance="line" animation="pulse">
                    </ngx-skeleton-loader>
                  </td>
                  <td>
                    <div [ngClass]="checkListRecord === false ? 'd-none' : ''">
                      {{ getMonthlyBudget(month, rowData,'monthly').Budget.Difference | currency:'USD':'symbol':'1.0-0'
                      }}
                    </div>
                    <ngx-skeleton-loader [ngClass]="checkListRecord === true ? 'd-none' : ''" count="1"
                      appearance="line" animation="pulse">
                    </ngx-skeleton-loader>
                  </td>
                </ng-container>
                <ng-container *ngIf="!getMonthlyBudget(month, rowData,'monthly')">
                  <!-- If data is not available for the specific month and CleaningType -->
                  <td colspan="3">N/A</td>
                </ng-container>
              </ng-container>
            </tr>
          </ng-template>
        </p-table>
        <div *ngIf="!budgetSummaryDetails && !preloading" class="p-3 ng-select-container">
          No Record Found....
        </div>
      </div>

      <div class="col-12" *ngIf="!preloading" id="secondDiv" #target>
        <h6 class="my-3" style="font-weight: 600">YTD Summary Yearly</h6>
        <p-table *ngIf="yearTotalSummaryDetails" #dt1 [value]="yearTotalSummaryDetails"
          class="p-datatable p-component p-datatable-sm" dataKey="CleaningType" [showCurrentPageReport]="true"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
          [globalFilterFields]="['CleaningType']" [tableStyle]="{ 'min-width': '40rem' }" [columns]="cols">
          <ng-template pTemplate="header" style="border-bottom: none; border: 2px solid" let-columns>
            <tr>
              <th rowspan="2" style="width: 25%">Cost Heads</th>
              <ng-container *ngFor="let item of yearTotalSummary">
                <th colspan="3" class="text-center">
                  {{ item?.MonthName }}-{{ item?.Year }}
                </th>
              </ng-container>
            </tr>
            <tr>
              <ng-container *ngFor="let item of yearTotalSummary">
                <th pSortableColumn="Budget">
                  Budget
                </th>
                <th pSortableColumn="Actual">
                  Actual
                </th>
                <th pSortableColumn="Difference">
                  Diff.
                </th>
              </ng-container>
              <!-- <th style="width: 2%; color"></th> -->
            </tr>
          </ng-template>

          <!-- ... (previous code) ... -->

          <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr>
              <!-- <td>{{ rowData.CleaningType }}</td> -->
              <td *ngIf="rowData?.CleaningType === 'TCC'">
                Total Cleaning Costs
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCB'">
                Additional Crew Bonus
              </td>
              <td *ngIf="rowData?.CleaningType === 'ITD'">
                Idle Time Days For Cleaning
              </td>
              <td *ngIf="rowData?.CleaningType === 'SHA'">
                Hold Advisory by Shore & Roving Supdt Cost
              </td>
              <td *ngIf="rowData?.CleaningType === 'ITC'">
                Idle Time Cost (Fixture Costs)
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCE'">
                Hold Cleaning Equipment
              </td>
              <td *ngIf="rowData?.CleaningType === 'ITB'">
                Idle Time Bunker $ (LSF+LSG)
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCC'">
                Hold Cleaning Chemicals
              </td>
              <td *ngIf="rowData?.CleaningType === 'SCG'">
                Shore Cleaning Gang
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCX'">
                Hold Cleaning Consumables
              </td>
              <ng-container *ngFor="let month of yearTotalSummary">
                <ng-container *ngIf="getMonthlyBudget(month, rowData,'yearly')">
                  <td>
                    <div [ngClass]="checkListRecord === false ? 'd-none' : ''">
                      {{ getMonthlyBudget(month, rowData,'yearly').Budget.BudgetSum | currency:'USD':'symbol':'1.0-0' }}
                    </div>
                    <ngx-skeleton-loader [ngClass]="checkListRecord === true ? 'd-none' : ''" count="1"
                      appearance="line" animation="pulse">
                    </ngx-skeleton-loader>
                  </td>
                  <td>
                    <div [ngClass]="checkListRecord === false ? 'd-none' : ''">
                      {{ getMonthlyBudget(month, rowData,'yearly').Budget.ActualSum | currency:'USD':'symbol':'1.0-0' }}
                    </div>
                    <ngx-skeleton-loader [ngClass]="checkListRecord === true ? 'd-none' : ''" count="1"
                      appearance="line" animation="pulse">
                    </ngx-skeleton-loader>
                  </td>
                  <td>
                    <div [ngClass]="checkListRecord === false ? 'd-none' : ''">
                      {{ getMonthlyBudget(month, rowData,'yearly').Budget.Difference | currency:'USD':'symbol':'1.0-0'
                      }}
                    </div>
                    <ngx-skeleton-loader [ngClass]="checkListRecord === true ? 'd-none' : ''" count="1"
                      appearance="line" animation="pulse">
                    </ngx-skeleton-loader>
                  </td>
                </ng-container>
                <ng-container *ngIf="!getMonthlyBudget(month, rowData,'yearly')">
                  <!-- If data is not available for the specific month and CleaningType -->
                  <td colspan="3">N/A</td>
                </ng-container>
              </ng-container>
            </tr>
          </ng-template>
        </p-table>
        <div *ngIf="!yearTotalSummaryDetails && !preloading" class="p-3 ng-select-container">
          No Record Found....
        </div>
      </div>

      <div class="col-12" *ngIf="!preloading" id="thirdDiv" #target>
        <h6 class="my-3" style="font-weight: 600">Quarterly Summary</h6>
        <p-table *ngIf="QSSummarySummaryDetails" #dt1 [value]="QSSummarySummaryDetails"
          class="p-datatable p-component p-datatable-sm" dataKey="CleaningType" [showCurrentPageReport]="true"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
          [globalFilterFields]="['CleaningType']" [tableStyle]="{ 'min-width': '40rem' }" [columns]="cols">
          <ng-template pTemplate="header" style="border-bottom: none; border: 2px solid" let-columns>
            <tr>
              <th rowspan="2" style="width: 25%">Cost Heads</th>
              <ng-container *ngFor="let item of QSSummary">
                <th colspan="3" class="text-center">
                  Q-{{ item?.Quarter }}
                </th>
              </ng-container>
            </tr>
            <tr>
              <ng-container *ngFor="let item of QSSummary">
                <th pSortableColumn="Budget">
                  Budget
                </th>
                <th pSortableColumn="Actual">
                  Actual
                </th>
                <th pSortableColumn="Difference">
                  Diff.
                </th>
              </ng-container>
              <!-- <th style="width: 2%; color"></th> -->
            </tr>
          </ng-template>

          <!-- ... (previous code) ... -->

          <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr>
              <!-- <td>{{ rowData.CleaningType }}</td> -->
              <td *ngIf="rowData?.CleaningType === 'TCC'">
                Total Cleaning Costs
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCB'">
                Additional Crew Bonus
              </td>
              <td *ngIf="rowData?.CleaningType === 'ITD'">
                Idle Time Days For Cleaning
              </td>
              <td *ngIf="rowData?.CleaningType === 'SHA'">
                Hold Advisory by Shore & Roving Supdt Cost
              </td>
              <td *ngIf="rowData?.CleaningType === 'ITC'">
                Idle Time Cost (Fixture Costs)
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCE'">
                Hold Cleaning Equipment
              </td>
              <td *ngIf="rowData?.CleaningType === 'ITB'">
                Idle Time Bunker $ (LSF+LSG)
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCC'">
                Hold Cleaning Chemicals
              </td>
              <td *ngIf="rowData?.CleaningType === 'SCG'">
                Shore Cleaning Gang
              </td>
              <td *ngIf="rowData?.CleaningType === 'HCX'">
                Hold Cleaning Consumables
              </td>
              <ng-container *ngFor="let month of QSSummary">
                <ng-container *ngIf="getMonthlyBudget(month, rowData,'quaterly')">
                  <td>
                    <div [ngClass]="checkListRecord === false ? 'd-none' : ''">
                      {{ getMonthlyBudget(month, rowData,'quaterly')?.Budget?.BudgetSum |
                      currency:'USD':'symbol':'1.0-0' }}
                    </div>
                    <ngx-skeleton-loader [ngClass]="checkListRecord === true ? 'd-none' : ''" count="1"
                      appearance="line" animation="pulse">
                    </ngx-skeleton-loader>
                  </td>
                  <td>
                    <div [ngClass]="checkListRecord === false ? 'd-none' : ''">
                      {{ getMonthlyBudget(month, rowData,'quaterly')?.Budget?.ActualSum |
                      currency:'USD':'symbol':'1.0-0' }}
                    </div>
                    <ngx-skeleton-loader [ngClass]="checkListRecord === true ? 'd-none' : ''" count="1"
                      appearance="line" animation="pulse">
                    </ngx-skeleton-loader>
                  </td>
                  <td>
                    <div [ngClass]="checkListRecord === false ? 'd-none' : ''">
                      {{ getMonthlyBudget(month, rowData,'quaterly')?.Budget?.Difference |
                      currency:'USD':'symbol':'1.0-0' }}
                    </div>
                    <ngx-skeleton-loader [ngClass]="checkListRecord === true ? 'd-none' : ''" count="1"
                      appearance="line" animation="pulse">
                    </ngx-skeleton-loader>
                  </td>
                </ng-container>
                <ng-container *ngIf="!getMonthlyBudget(month, rowData,'quaterly')">
                  <!-- If data is not available for the specific month and CleaningType -->
                  <td colspan="3">N/A</td>
                </ng-container>
              </ng-container>
            </tr>
          </ng-template>
        </p-table>
        <div *ngIf="!QSSummarySummaryDetails && !preloading" class="p-3 ng-select-container">
          No Record Found....
        </div>

      </div>
    </div>


  </nb-card-body>


</nb-card>